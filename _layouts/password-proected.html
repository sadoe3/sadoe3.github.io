---
layout: default # Or the layout your protected content would normally use (e.g., 'post', 'page')
---

<!-- This file defines a custom layout for password-protected Jekyll content. -->
<!-- It prompts the user for a password and only reveals the content after a successful entry. -->

<div id="password-wrapper" class="relative min-h-screen flex items-center justify-center p-4">
    <div id="authSection" class="bg-white p-8 rounded-xl shadow-xl max-w-md w-full border border-gray-200">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Access Protected Content</h1>
        <p class="text-gray-600 mb-6 text-center">
            This content is password protected. Please enter the password to view.
        </p>
        <div class="mb-4">
            <label for="passwordInput" class="block text-gray-700 text-sm font-medium mb-2">Password:</label>
            <input
                type="password"
                id="passwordInput"
                class="shadow-sm appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                placeholder="Enter password"
                onkeypress="handleKeyPress(event)"
            >
        </div>
        <div class="flex items-center mb-6">
            <input type="checkbox" id="rememberMe" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500 transition duration-150 ease-in-out">
            <label for="rememberMe" class="ml-2 text-gray-700 text-sm">Remember me on this device</label>
        </div>
        <button
            id="submitPassword"
            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg focus:outline-none focus:shadow-outline transition-colors duration-200 transform hover:scale-105 active:scale-95 shadow-md"
        >
            Unlock Content
        </button>
        <p id="errorMessage" class="text-red-600 text-sm mt-4 text-center hidden">
            Incorrect password. Please try again.
        </p>
    </div>
</div>

<!-- Protected Content Section (Initially Hidden) -->
<!-- This div will contain the actual content of the Jekyll post/page -->
<div id="protectedContent" class="hidden w-full px-4 py-8 max-w-4xl mx-auto">
    <!-- The actual content of the Jekyll post/page will be injected here -->
    {{ content }}
</div>

<!-- Message Box for Alerts (Replaces alert()) -->
<div id="messageBox" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
    <div class="bg-white p-8 rounded-xl shadow-xl max-w-sm w-full text-center">
        <p id="messageText" class="text-lg font-semibold text-gray-800 mb-4"></p>
        <button
            class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition-colors duration-200"
            onclick="closeMessageBox()"
        >
            OK
        </button>
    </div>
</div>

<script>
    // IMPORTANT: Change this to your desired password!
    // Make sure to use a strong, unique password.
    // Remember, this is client-side, so it's not truly secure against determined users.
    const CORRECT_PASSWORD = "{{ page.password | default: 'DEFAULT_SECURE_PASSWORD' }}"; // Can be set in front matter or use a default
    // If you want one global password for all protected content, you can hardcode it:
    // const CORRECT_PASSWORD = "MySuperSecretPassword123!";


    const passwordInput = document.getElementById('passwordInput');
    const submitButton = document.getElementById('submitPassword');
    const errorMessage = document.getElementById('errorMessage');
    const authSection = document.getElementById('authSection');
    const protectedContent = document.getElementById('protectedContent');
    const rememberMeCheckbox = document.getElementById('rememberMe');
    const messageBox = document.getElementById('messageBox');
    const messageText = document.getElementById('messageText');

    // Function to show a custom message box
    function showMessageBox(message) {
        messageText.textContent = message;
        messageBox.classList.remove('hidden');
    }

    // Function to close the custom message box
    function closeMessageBox() {
        messageBox.classList.add('hidden');
    }

    // Key for local storage to remember access
    const localStorageKey = 'pintos_access_granted_' + window.location.pathname;

    // Check for remembered password on load
    document.addEventListener('DOMContentLoaded', () => {
        const remembered = localStorage.getItem(localStorageKey);
        if (remembered === 'true') {
            authenticateUser();
        } else {
            // Ensure auth section is visible if not remembered
            authSection.classList.remove('hidden');
            protectedContent.classList.add('hidden');
        }
    });

    // Event listener for the button click
    if (submitButton) {
        submitButton.addEventListener('click', checkPassword);
    }

    // Event listener for Enter key press in the password input
    function handleKeyPress(event) {
        if (event.key === 'Enter') {
            checkPassword();
        }
    }

    function checkPassword() {
        const enteredPassword = passwordInput.value;

        // Use a simple equality check for the password
        if (enteredPassword === CORRECT_PASSWORD) {
            authenticateUser();
            if (rememberMeCheckbox.checked) {
                localStorage.setItem(localStorageKey, 'true');
            } else {
                localStorage.removeItem(localStorageKey);
            }
        } else {
            errorMessage.classList.remove('hidden');
            passwordInput.value = ''; // Clear input on incorrect password
            passwordInput.focus(); // Keep focus on the input
            showMessageBox('Incorrect password. Please try again.');
        }
    }

    function authenticateUser() {
        authSection.classList.add('hidden');
        document.getElementById('password-wrapper').classList.add('hidden'); // Hide the wrapper as well
        protectedContent.classList.remove('hidden');
        // Optional: Scroll to top of the content or smooth scroll
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
</script>
