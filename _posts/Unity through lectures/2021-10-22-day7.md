---
title: "Unity 강의 - Day 7"

categories:
    - unity-lecture

tags:
    - [Game Engine, Unity]

toc: true
toc_label: "목차"
toc_sticky: true

date: 2021-10-22
---

전주정보문화산업진흥원에서 진행하는 **게임콘텐츠(Unity3D) 제작 실무자 양성과정** 강의를 듣고 정리한 필기입니다.
{: .notice--warning}

## How to implement restart function easily
- 해당 scene을 다시 load하는 기능을 이용하여 restart 기능을 쉽게 구현할 수 있다.
- scene을 load하기 위해선 UnityEngine.SceneManagement namespace를 using해야 한다.
```c#
// example
using UnityEngine.SceneManagement;
... // some codes
public void RestartGame() {
    SceneManager.LoadScene("SceneName");
}
```

## Reset()
- Component를 right click후 reset menu를 눌렀을 때, 어떠한 처리를 하는지를 Reset()를 통해 설정해 줄 수 있다.
```c#
// example of using Reset method
private void Reset()
{
    ... // some codes
}
```

## How to find object through a script
- Unity에서 script를 사용하여, 즉 동적으로, 특정 object를 찾고 싶을 때에는 2가지 방법을 보통 사용한다.
- 첫번째 방법: tag를 이용하여, compareTag를 사용하는 방법
    - ex: collision이 일어났을때, collider를 대상으로 사용 할 수 있음
- 두번째 방법 empty script를 사용하는 방법
    - empty script를 만든다음, 해당 script를 특정 object에 넣어서, 임의의 component를 만든다.
    - 그런 후 script에서 FindObjectOfType을 이용하여 찾는다
- 나는 두번째 방법은 별로라고 생각했는데, 강사님이 두번째 방법이 직관적이라, 오히려 자주 사용한다고 하셨음. 
- 그래서 나도 다음부터는 object를 동적으로 찾고싶으면, 두번째 방법을 자주 사용해볼 생각이다.

## Difference between GetComponents and FindObjectsOfType
- GetComponents는 hierarchy의 순서를 바탕으로 object를 얻어오지만, FindObjectsOfType는 hierarchy의 순서와 상관없이 object를 얻어오는 경우도 있어서, hierarchy의 순서가 중요하면 GetComponents를 사용해야한다.

## UI에서 Image object 추가할 때 조심해야할 것
- Assets folder에서 바로 drag & drop으로 가져오면, 그렇게 해서 만들어지는 object는 Unity에서 UI로 인식을 하지 않아서, 다른 UI object에 가려지게 된다.
- 이 방법을 해결하기 위해선, canvas object에 우클릭 후, create -> UI -> Image로 object를 만들고, 이후 해당 object에서 Image component의 source를 asset folder에 있는 Image로 선택하면, 이제는 해당 object를 UI로 인식하여, 정상적으로 Image를 사용할 수 있게된다.  

## Unity InvalidOperationException during foreach statement
- [reference site](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=feena74&logNo=220534683331) 
- 가끔씩, foreach statement를 진행하다보면, InvalidOperationException: Collection was modified; enumeration operation may not execute. 라는 error message를 볼때가 있다.
- foreach statement가 처리되고 있는 도중에, foreach statement에 사용한 collection의 element가 제거되고, 계속 foreach문을 진행하려고 하면 해당 error가 발생하게 된다.
- 해결방법 상당히 간단하다, element를 access할 때, null check를 해주면된다.
- 근데 null check를 해도 unity는 계속 warning message를 주기 때문에, warning message를 지우고 싶으면, null check까지 한 내용을 for statement로 구현하면 해결할 수 있다.

## How to purchase assets with very cheap price
- 엄청 좋지만 비싼 asset들이 asset store에 있는데, 이들을 싸게 사려면 Halloween, Black Friday 같은 세일기간에 사면 엄청 싸게 살수있다.
- Black Friday에는 일정 기간동안만 한정된 수량으로 엄청 비싼 asset을 90%까지 할인하여 판매한다.
- 보통 50%할인이 대부분인데, Black Friday에는 90%할인까지하니 1년에 한번있는 Black Friday sale은 꼭 이용 하는것이 좋다.
    - 근데, 90%할인은 엄청 빨리 끝나서, 왠만하면 컴퓨터로 구매하는 것보단 4g or 5g를 키고 핸드폰으로 구매하는게 훨씬 빠르다.
    - 그냥 핸드폰으로 asset store 로그인한 뒤, 원하는 상품 페이지 이동한 다음, 90%할인 시작하면, 바로 buy now 누르고 결제를 진행해주면 된다.
- 50% 할인은 보통 2~3달 마다 정기적으로 진행함
    - 그래도 대부분의 인기 asset들을 sale하는 것은 보통 Black Friday 밖에 없다. 
- [이곳](https://assetstore.unity.com/top-assets/top-download)에서 현재 top downloaded asset을 볼수있다.

## How to draw a cube from OnDrawGizmo based on the location of camera and player
```c#
    private void OnDrawGizmos()
    {
        Gizmos.color = Color.blue;
        
        Gizmos.DrawWireCube(player.transform.position + new Vector3((player.neckTransform.position-Camera.main.transform.position).normalized.x, 0.5f, (player.neckTransform.position-Camera.main.transform.position).normalized.z), new Vector3(distanceToInteract, player.transform.lossyScale.y, distanceToInteract));
    }    
```
- 여기서 new vector3(player.~) 으로 구성된 vector 값을 바꾸면, cube의 시작 위치가 바뀐다
- 이 코드를 바탕으로 변경하고 싶은 값을 적절히 변경하면 됨

## How to change source of image in script
```c#
Sprite imagePrefab = Resources.Load<Sprite>("ImageName");
... // some codes
Image imageTemp = GetComponent<Image>();
imageTemp.sprite = imagePrefab;
```

## Animation Clips 
- 동일한 animation file이여도, 복제해서 사용하면, 다른 animation event를 추가할 수 있다.

## Stats
- Game window의 우측 상단에 있는 Stats button을 누르게 되면 현재 개발 중인 게임의 FPS같은 정보를 볼 수 있다.

## Exit Time of animation
- 특정 animation file을 실행시킨 뒤, 몇초 후에 다른 animation으로 넘어가게 하고 싶으면, animator window에서 해당 animation에서 exit으로 가는 transition을 누르고, inspector window에서 has exit time을 체크한 뒤, settings에서 exit time을 원하는 시간으로 설정해주면 된다.

## Coroutine and timescale
- Coroutine으로 설정된 시간은 timescale에 영향을 받는다.
    - 즉 1초를 기다린다 했을때, time scale이 0.1로 설정되어있으면 10초를 기다리게 된다는 의미.

## DontDestroyOnLoad(gameObject)
- DontDestroyOnLoad(gameObject);를 awake()에서 사용하면, 해당 object는 scene을 넘어가도 지워지지 않는다.
- 그러면 loaded 되는 scene에서는 해당 object를 만들지 않고, 그냥 처음에 시작된 scene에 있는 object를 loaded된 두번째 scene에서 사용하면 된다.

## Prefab to move object between scense
- scene에서 scene으로 특정 object를 옮기고 싶으면, 해당 object를 prefab으로 만들어서 옮겨주면 된다.

## Issue regarding Timescale
- Timescale은 scene을 load해도 reset되지 않기 때문에, scene을 load할때마다 time scale을 reset하고 싶으면, 직접 time scale을 reset 해줘야 한다.

## EventSystem object
- UI에서 아무 object를 create하게 되면, 자동적으로 `EventSystem`이라는 object가 생성되게 되는데, 이 object를 지우게 되면, button같은 event handling이 안되기 때문에, 자동생성된 `EventSystem` object는 UI를 사용할때에는 지우지말고 계속 갖고있어야한다.

## Navigation of Button
- Button object를 Unity에서 만들면, 기본적으로 Navigation 값이 `Automatic`으로 되어있는데, 이걸 하게 되면, 자동적으로 키보드 방향키로 버튼들을 대상으로 움직이게 할수있다.
- 즉, 버튼 1, 2, 3번이 수직으로 존재하게 되었을 경우, 버튼 1번을 누르고, 방향키 아래를 한번 누른뒤, 엔터를 누르게 되면, 자동적으로 버튼 2번이 눌러지게 된다.
- 문제는 현재 버튼2번을 navigation이 가르키고 있다고 해도, 그걸 시각적으로 보여주지 않기때문에, 이런 기능이 있다는걸 모르면, 왜 버튼2번이 눌러지는지를 알기가 어렵다.
- 그래서 이런 기능을 사용하고 싶지 않다면, navigation값을 `None`으로 설정해주면 된다.

## Issue regarding DontDestroyOnLoad 
- `DontDestroyOnLoad`로 설정하고 싶은 object는 특정 object의 하위 object로 존재하면 안된다.
- 그 이유는, 만약에 특정 object의 하위 object로 존해하는 object에게 `DontDestroyOnLoad`를 설정한다고 해도, 해당 기능이 적용되지 않기 때문이다.
- 그래서 `DontDestroyOnLoad`를 사용하고 싶은 object는 최상위 object로 설정해줘야한다.

## How to solve problem where Unity suddenly stopped
- Unity가 렉을 먹으면서 갑자기 멈추는 경우, 여러 이유가 있겠지만 보통 무한 루프가 걸려서 이런 이유가 발생한다고 생각하면 된다.
- 이 현상은 코루틴을 사용한 함수가 무한루프에 걸렸을 때에도 발생하기 때문에, 코루틴을 사용하든 그 어떤 상황에도 Unity 내의 script에서 무한루프가 되는 상황을 막아야 해당 문제를 해결할 수 있게된다.

## temp

[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}