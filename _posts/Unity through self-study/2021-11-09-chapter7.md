---
title: "ReadOnly Attribute"

categories:
    - unity-self

tags:
    - [Game Engine, Unity, ReadOnly]

toc: true
toc_label: "목차"
toc_sticky: true

date: 2021-11-09
---

## ReadOnly Attribute
- 특정 script의 public member를 Unity editor에서는 보고싶지만, 수정은 되지 않게하려면 해당 data member에 ReadOnly Attribute을 넣어주면 된다.
- 근데, 아쉽게도 현재 Unity에서는 이 기능을 지원해주지 않고있어서, 사용자가 custom으로 ReadOnly Attribute을 만들어서 사용해줘야한다.
- 그래도 다행히, 인터넷에 검색을 해보면 좋은 script file들이 있기때문에, 적절히 좋은 script file을 참고하여 사용해주면 된다.
- 이번 포스트에서는 [이곳](https://drehzr.tistory.com/654)에서 script file을 참고하여 사용했다.
- 다만 기억해야되는 포인트는 Unity Editor name space는 말그대로 unity editor에서만 사용가능한 코드이고, build에서는 사용할수가 없다.
    - 그래서 보통 c#의 preprocessing 기능을 이용해서 현재 UNITY_EDITOR일때만, 해당코드를 추가하도록 설정해줘야, build할때 오류가 안나게 된다.
    - ReadOnly를 제외하더라고, Unity에서 scripting을 할때 UnityEditor namespace를 사용하는 code는 반드시 preprocessing으로 UNITY_EDITOR에서만 실행되도록 제어해야 Build할때 오류가 나지 않는다.
    - 아래의 코드는 내가 위의 사이트를 참고해서 약간 변형시킨 코드이다.
    - 핵심은 Runtime일때에는 ReadOnly Attribute을 아무런 역할을 하지 않는 빈 attribute으로 만들어줘서, Build할때 error가 나지않게 했다.
    - System namespace는 없으면 build가 안되길래 추가했다. 

## How to use ReadOnly Attributes
1. Assets window안에 scripts folder 안에서 ReadOnlyAttribute script를 만들고, 그곳에 코드를 적절히 적는다.
```c#
using System;
using UnityEngine;
#if UNITY_EDITOR
using UnityEditor;
public class ReadOnlyAttribute : PropertyAttribute
{ 
}

[CustomPropertyDrawer(typeof(ReadOnlyAttribute))]ㄴㄴㄴ
public class ReadOnlyDrawer : PropertyDrawer
{
    public override float GetPropertyHeight(SerializedProperty property, GUIContent label)
    {
        return base.GetPropertyHeight(property, label);
    }

    public override void OnGUI(Rect position, SerializedProperty property, GUIContent label)
    {
        GUI.enabled = false;
        EditorGUI.PropertyField(position, property, label, true);
        GUI.enabled = true;
    }
}
#else
[AttributeUsage(AttributeTargets.Field)]
public class ReadOnlyAttribute : PropertyAttribute
{ }
#endif
```
2. 이후 다른 script파일에 ReadOnly attribute을 적용할 적절한 public data member를 만들어서 적절히 사용해주면 된다.
```c#
[ReadOnly] public int power = 300;
```

## private data member를 editor에서 보이게 하는 방법
- private data member에 `[ReadOnly, SerializeField]` attribute을 추가하면, data member가 private이여도, Unity Editor에서 ReadOnly로 보이게 된다. 


[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}